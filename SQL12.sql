select  ProductID as ????,ProductName as ??????,
		UnitsInstock + UnitsOnOrder as ????????????,
		ReorderLevel as ??????????? 
from Products
where (Unitsinstock + UnitsOnOrder) < ReorderLevel

select ProductID, ProductName,UnitPrice,
	ROUND( Unitprice * 0.07,2) AS vat7
from Products

select EmployeeID,TitleOfCourtesy+FirstName+space(1)+LastName as [Employee Name]
From Employees

--????????????????????????????????????????? 10250 ???????? (order 
select * 
From [Order Details]
where orderID = 10250

select OrderID,ProductID, Unitprice,Quantity,Discount,
	   UnitPrice * Quantity * (1-Discount) as netprice
From [Order Details]
where OrderID = 10250

-- ???????? - ??????
-- ???????? = ???? * ?????
-- ?????? = ???? * ????? * ??????
-- (???? * ?????) - (???? * ????? * ??????)

-- ??????? !!!!1
-- ???? * ???????????*(1-??????)

--?????? Aggregate Function
Select COUNT(*)AS ???????????
from Products
where UnitsInStock < 15

--???????????????????????
select COUNT(*) as ????? from Employees
--????????????????????????????????????? Brazil
select COUNT(*) from Customers where Country = 'Brazil'
--??????????????????????????????????????????????? 10250
select COUNT(*) from [Order Details] where orderID=10250
--??????????????????????????????????????????? Japan
select COUNT(*) from Orders where ShipCity = 'Japan'

--????????????????? ?????? ?????? ?????????
select min(UnitPrice) as ?????????? , max(UnitPrice) as ??????????,
	AVG(UnitPrice) as ??????????
From Products

--????????????????? ?????????? ????????????? ????????????? 5 ????????? [order details]
select AVG(UnitPrice),max(UnitPrice),min(Unitprice)
from[Order Details]
where ProductID = 5

--?????????????? ???????????????????????????
select Country,COUNT(*) as ???????????
From Customers
group by Country
order by [???????????]desc

--?????????????? ????? ??????????????????????????
select Country,City,COUNT(*) as ???????????
From Customers
group by Country,City
order by [???????????]desc

--????????????????????????????????????????????????? --oders
select ShipCountry, COUNT(*)???????????????
from Orders
group by ShipCountry

--?????????????? ???????????????????????????-- ??????????????????1
select Country,City,COUNT(*) as ???????????
From Customers
group by Country
HAVING COUNT(*) >1

-- ?????????????????????????????????????????????????? 1997
--??????????????????????????????? 5 ??????
select ShipCountry , COUNT(*) ???????????????
From Orders 
Where YEAR(OrderDate) = 1997
Group by ShipCountry
HAVING COUNT(*) <5

--????????????????? ????????????????????? 
Select ProductID,Sum(Quantity) As ??????????????
From [Order Details]
Group by ProductID
Order by ProductID

--????????????????? ?????????????????????  ?????????? ?????????? ?????????
Select ProductID,Sum(Quantity) As ??????????????,
		max(Unitprice) ??????????,min(UnitPrice) ??????????,
		AVG(UnitPrice) ??????????
From [Order Details]
Group by ProductID
HAVING Sum(Quantity)>1000
Order by ProductID

--????????????????????? ????????????????????????????? [Order Dateils]
select OrderID,Sum(Unitprice * Quantity * (1-Discount))as ToTalPrice
From [Order Details]
Group by OrderID